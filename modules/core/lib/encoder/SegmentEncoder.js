"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SegmentEncoder=void 0;var Base64Url_1=require("./Base64Url"),BitLength_1=require("./BitLength"),field_1=require("./field"),sequence_1=require("./sequence"),errors_1=require("../errors"),Fields_1=require("../model/Fields"),model_1=require("../model"),SegmentEncoder=function(){function e(){}return e.decode=function(e,r,i){var t=this,n=Base64Url_1.Base64Url.decode(e),s=0;return i===model_1.Segment.CORE&&(r.version=field_1.IntEncoder.decode(n.substr(s,BitLength_1.BitLength[Fields_1.Fields.version]),BitLength_1.BitLength[Fields_1.Fields.version])),i!==model_1.Segment.CORE&&(s+=BitLength_1.BitLength.segmentType),this.fieldSequence[""+r.version][i].forEach((function(e){var i=field_1.FieldEncoderMap[e],o=BitLength_1.BitLength[e];if(void 0===o&&t.isPublisherCustom(e)&&(o=+r[Fields_1.Fields.numCustomPurposes]),0!==o){var d=n.substr(s,o);if(r[e]=i.decode(d,o),Number.isInteger(o))s+=o;else{if(!Number.isInteger(r[e].bitLength))throw new errors_1.DecodingError(e);s+=r[e].bitLength}}})),r},e.isPublisherCustom=function(e){return 0===e.indexOf("publisherCustom")},e.fieldSequence=new sequence_1.FieldSequence,e}();exports.SegmentEncoder=SegmentEncoder;